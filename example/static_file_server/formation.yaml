HttpServer StaticFileServer:
  ENV:
    PATH: null
  ASSIGN:
    $staticBasePath: ENV.PATH

Fork forkRequest:
  ENV.DISTRIBUTE: copy
   
Process orderMediaTypeFirst:
  COMMAND: node lib/orderMediaTypeFirst

# There don't seem to be reasons to have this configurable
# ENV.PICK: as_comes
Merge mergeResponse: {}

Process lookupMediaType:
  COMMAND: node lib/lookupMediaType

Process readFile:
  ASSIGN:
    ENV.BASE_PATH: $staticBasePath
  COMMAND: node lib/readFile

Flow:
  - StaticFileServer -> forkRequest
  - forkRequest -> lookupMediaType -> mergeResponse
  - forkRequest -> readFile -> mergeResponse
  - mergeResponse -> orderMediaTypeFirst -> StaticFileServer